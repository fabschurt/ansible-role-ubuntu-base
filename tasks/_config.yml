---
- name: Upload custom config files
  tags: [config]
  copy:
    src: '{{ item }}'
    dest: '/{{ item }}'
    mode: 0644
  with_items:
    - etc/ssh/
    - etc/pam.d/
    - etc/profile
    - etc/bash.bashrc
    - etc/login.defs
    - etc/adduser.conf
    - etc/deluser.conf

- name: Upload custom config templates
  tags: [config]
  template:
    src: '{{ item }}'
    dest: '/{{ item }}'
    mode: 0644
  with_items:
    - etc/ntp.conf
    - etc/mailname
    - etc/postfix/main.cf
    - etc/aliases
  notify:
    - Restart NTP
    - Restart Postfix
    - Register new aliases

- name: Ensure host name has a match in hosts file
  tags: [config]
  lineinfile:
    line: '127.0.1.1 {{ ansible_fqdn }}'
    state: present
    dest: /etc/hosts
    insertbefore: BOF
